clc;clear all
N = 1001;
h = 2./(N-1);
dt = 0.0001;
P = dt./(h.^2);
Tspan = 1000;
phi = zeros(N,Tspan);
V(1) = 0;
V(N) = 0;
x = -1: h: 1;

for i = 2:N-1
    %x(i) = 2.*((i-1).*h-0.5);
    V(i) = -2500.*(0.5*x(i).^2-1);
    phi(i,1) = (x(i)+1).*(1-x(i));
end
phi([1, end], :) = 0.0;
%%%%%%%%%%%%%%%%%%%%%%%%%%初始条件%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%x(1) = -1;
%x(N) = 1;
%%%%%%%%%%%%%%%%%%%%%%%%%%%迭代%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a = zeros(1,N-2) - P; a(1) = 0.0;
c = zeros(1,N-2) - P; c(end) = 0.0;
b = zeros(1,N-2) + 1.0 + 2*P - dt.*V(2:1:(N-1));
for i = 1:Tspan-1
    phi(2:1:(N-1), i+1) = chase(a, b, c, phi(2:1:(N-1), i));
    %for j = 2:N-1
        %phi(j,i+1) = (V(j)*dt+1).*phi(j,i)-P.*(phi(j-1,i)+phi(j+1,i)...
        %    -2.*phi(j,i));
    %end
    sum_of_square = sum(phi(:,i+1).^2.0)*h;
%%%%%%%%%%%%%%%%%%%%%%%%%%归一化%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
   
    phi(:,i+1) = phi(:,i+1)./sqrt(sum_of_square);
%%%%%%%%%%%%%%%%%%%%%%%%%%画图（扩散过程）%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
    %plot(x,phi(:,i+1)),pause(0.05)
    
%%%%%%%%%%%%%%%%%%%%%%%%%%求本征值的演化过程%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    E = 0;
    for k = 2:N
        E = E+0.5.*(phi(k,i)-phi(k-1,i)).^2./h+h.*V(k).*phi(k,i).^2;
    end
    energy_value_num(i) = E;
end
plot(x, phi(:, Tspan));

